<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html xmlns:og="http://ogp.me/ns#">
<head>
    <title>Apache Kafka</title>
<link rel='stylesheet' href='http://localhost:8080/35/documentation/css/styles.css?2' type='text/css'>
<link rel="icon" type="image/gif" href="http://localhost:8080/35/documentation/images/apache_feather.gif">
<meta name="robots" content="index,follow"/>
<meta name="language" content="en"/>
<meta name="keywords" content="apache kafka messaging queuing distributed stream processing">
<meta name="description" content="Apache Kafka: A Distributed Streaming Platform.">
<meta http-equiv='Content-Type' content='text/html;charset=utf-8'/>
<meta name="viewport" content="initial-scale = 1.0,maximum-scale = 1.0"/>
<meta property="og:title" content="Apache Kafka"/>
<meta property="og:image" content="http://apache-kafka.org/images/apache-kafka.png"/>
<meta property="og:description" content="Apache Kafka: A Distributed Streaming Platform."/>
<meta property="og:site_name" content="Apache Kafka"/>
<meta property="og:type" content="website"/>
<link href="http://localhost:8080/35/documentation/css/fonts.css" rel="stylesheet">
<script src="http://localhost:8080/35/documentation/js/jquery.min.js"></script>
<script defer src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"></script>

<link rel="stylesheet" href="http://localhost:8080/35/documentation/css/prism.min.css"/>
<script defer src="http://localhost:8080/35/documentation/js/prism.min.js"></script>

<script>
			
			
			
			var legacyDocPaths = [
				'/07/documentation',
				'/07/documentation/',
				'/08/documentation',
				'/08/documentation/',
				'/081/documentation',
				'/081/documentation/',
				'/082/documentation',
				'/082/documentation/',
				'/090/documentation',
				'/090/documentation/',
				'/0100/documentation',
				'/0100/documentation/'
			];

			
			
			var currentPath = window.location.pathname;
			var shouldRedirect = !legacyDocPaths.includes(currentPath);
			var isDocumenationPage = currentPath.includes('/documentation');

			var hasNotSpecifiedFullPath = !currentPath.includes('/documentation/streams') && !currentPath.includes('/documentation/streams/');

			
			
			var specifiedStreamsAnchor = window.location.hash.includes('#streams_');

			if (shouldRedirect && isDocumenationPage && hasNotSpecifiedFullPath) {
				if (specifiedStreamsAnchor) {
					window.location.pathname = currentPath + 'streams';
				}
			}





    </script>

<script>
			var _paq = window._paq = window._paq || [];
			 
			 
			_paq.push(['disableCookies']);
			_paq.push(['trackPageView']);
			_paq.push(['enableLinkTracking']);
			(function() {
				var u="//matomo.privacy.apache.org/";
				_paq.push(['setTrackerUrl', u+'matomo.php']);
				_paq.push(['setSiteId', '26']);
				var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
				g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
			})();





    </script>


</head>
<body>
<div class="main">
    <div class="header" id="header">
    <a href="/" class="logo-link">
        <span class="visually-hidden">Apache Kafka</span>
    </a>

    <button type="button" class="top-nav-toggle burger-toggle" id="top-nav-toggle" aria-haspopup="true" aria-expanded="false">
        <span class="visually-hidden">Toggle navigation</span>
        <span class="burger-line"></span>
        <span class="burger-line"></span>
        <span class="burger-line"></span>
    </button>

    <div class="top-nav-container" id="top-nav-container">
        <nav class="top-nav" role="navigation" aria-label="Main menu">
            <ul class="top-nav-list">
                <li class="top-nav-item" role="menuitem">
                    <a href="#" class="top-nav-item-anchor" aria-haspopup="true" aria-expanded="false">
                        Get Started
                    </a>
                    <ul class="top-nav-menu" aria-hidden="true" role="menu" title="Get Started">
                        <li class="top-nav-menu-item" role="menuitem">
                            <a href="/intro" tabindex="-1" class="top-nav-anchor">
                                Introduction
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a href="/quickstart" tabindex="-1" class="top-nav-anchor">
                                Quickstart
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a href="/uses" tabindex="-1" class="top-nav-anchor">
                                Use Cases
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a href="/books-and-papers" tabindex="-1" class="top-nav-anchor">
                                Books &amp; Papers
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a href="/videos" tabindex="-1" class="top-nav-anchor">
                                Videos
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a href="/podcasts" tabindex="-1" class="top-nav-anchor">
                                Podcasts
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="top-nav-item" role="menuitem">
                    <a href="/documentation" class="top-nav-item-anchor" aria-haspopup="true" aria-expanded="false" aria-controls="nav-documentation-menu">
                        Docs
                    </a>
                    <ul class="top-nav-menu" aria-hidden="true" role="menu" id="nav-documentation-menu" title="Docs">
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="/documentation#gettingStarted">
                                Key Concepts
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="/documentation#api">
                                APIs
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="/documentation#configuration">
                                Configuration
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="/documentation#design">
                                Design
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="/documentation#implementation">
                                Implementation
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="/documentation#operations">
                                Operations
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="/documentation#security">
                                Security
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="https://cwiki.apache.org/confluence/display/KAFKA/Clients" target="_blank">
                                Clients
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="/documentation#connect">
                                Kafka Connect
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="/documentation/streams">
                                Kafka Streams
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="top-nav-item" role="menuitem">
                    <a class="top-nav-item-anchor" href="/powered-by">
                        Powered By
                    </a>
                </li>
                <li class="top-nav-item" role="menuitem">
                    <a href="#" class="top-nav-item-anchor" aria-haspopup="true" aria-expanded="false" aria-controls="nav-community-menu">
                        Community
                    </a>
                    <ul class="top-nav-menu" aria-hidden="true" role="menu" id="nav-community-menu" title="Community">
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="https://kafka-summit.org/" target="_blank">
                                Kafka Summit
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="/project">
                                Project Info
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="/trademark">
                                Trademark
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="https://cwiki.apache.org/confluence/display/KAFKA/Ecosystem" target="_blank">
                                Ecosystem
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="/events">
                                Events
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="/contact">
                                Contact us
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="top-nav-item" role="menuitem">
                    <a href="#" class="top-nav-item-anchor" aria-haspopup="true" aria-expanded="false" aria-controls="nav-community-menu">
                        Apache
                    </a>
                    <ul class="top-nav-menu" aria-hidden="true" role="menu" id="nav-community-menu" title="Community">
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="https://www.apache.org/licenses/" target="_blank">
                                License
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="https://www.apache.org/foundation/sponsorship.html" target="_blank">
                                Donate
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="https://www.apache.org/foundation/thanks.html" target="_blank">
                                Sponsors
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="https://www.apache.org/security/" target="_blank">
                                Security
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank">
                                Privacy
                            </a>
                        </li>
                        <li class="top-nav-menu-item" role="menuitem">
                            <a class="top-nav-anchor" tabindex="-1" href="https://www.apache.org/" target="_blank">
                                Apache.org
                            </a>
                        </li>
                    </ul>
                </li>
                <li class="top-nav-item" role="menuitem">
                    <a href="/downloads" class="top-nav-download" tabindex="-1" id="top-nav-download">
                        Download Kafka
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</div>

</div>
<div class="main">
    <div class="content documentation documentation--current">
        <div class="toc-handle-container">
            <div class="toc-handle">&lt;</div>
        </div>
        <div class="docs-nav">
            <ul class="toc">
    <li>1. Getting Started
        <ul>
            <li><a href="http://localhost:8080/35/documentation/introduction">1.1 Introduction</a>
            <li><a href="http://localhost:8080/35/documentation/uses">1.2 Use Cases</a>
            <li><a href="http://localhost:8080/35/documentation/quickstart">1.3 Quick Start</a>
            <li><a href="http://localhost:8080/35/documentation/ecosystem">1.4 Ecosystem</a>
            <li><a href="http://localhost:8080/35/documentation/upgrade">1.5 Upgrading</a>
        </ul>
    </li>
    <li><a href="http://localhost:8080/35/documentation/api">2. APIs</a>
        <ul>
            <li><a href="http://localhost:8080/35/documentation/api#producerapi">2.1 Producer API</a>
            <li><a href="http://localhost:8080/35/documentation/api#consumerapi">2.2 Consumer API</a>
            <li><a href="http://localhost:8080/35/documentation/api#streamsapi">2.3 Streams API</a>
            <li><a href="http://localhost:8080/35/documentation/api#connectapi">2.4 Connect API</a>
            <li><a href="http://localhost:8080/35/documentation/api#adminapi">2.5 Admin API</a>
        </ul>
    </li>
    <li><a href="http://localhost:8080/35/documentation/configuration">3. Configuration</a>
        <ul>
            <li><a href="http://localhost:8080/35/documentation/configuration#brokerconfigs">3.1 Broker Configs</a>
            <li><a href="http://localhost:8080/35/documentation/configuration#topicconfigs">3.2 Topic Configs</a>
            <li><a href="http://localhost:8080/35/documentation/configuration#producerconfigs">3.3 Producer Configs</a>
            <li><a href="http://localhost:8080/35/documentation/configuration#consumerconfigs">3.4 Consumer Configs</a>
            <li><a href="http://localhost:8080/35/documentation/configuration#connectconfigs">3.5 Kafka Connect Configs</a>
                <ul>
                    <li><a href="http://localhost:8080/35/documentation/configuration#sourceconnectconfigs">Source Connector Configs</a>
                    <li><a href="http://localhost:8080/35/documentation/configuration#sinkconnectconfigs">Sink Connector Configs</a>
                </ul>
            <li><a href="http://localhost:8080/35/documentation/configuration#streamsconfigs">3.6 Kafka Streams Configs</a>
            <li><a href="http://localhost:8080/35/documentation/configuration#adminclientconfigs">3.7 AdminClient Configs</a>
        </ul>
    </li>
    <li><a href="http://localhost:8080/35/documentation/design">4. Design</a>
        <ul>
            <li><a href="http://localhost:8080/35/documentation/design#majordesignelements">4.1 Motivation</a>
            <li><a href="http://localhost:8080/35/documentation/design#persistence">4.2 Persistence</a>
            <li><a href="http://localhost:8080/35/documentation/design#maximizingefficiency">4.3 Efficiency</a>
            <li><a href="http://localhost:8080/35/documentation/design#theproducer">4.4 The Producer</a>
            <li><a href="http://localhost:8080/35/documentation/design#theconsumer">4.5 The Consumer</a>
            <li><a href="http://localhost:8080/35/documentation/design#semantics">4.6 Message Delivery Semantics</a>
            <li><a href="http://localhost:8080/35/documentation/design#replication">4.7 Replication</a>
            <li><a href="http://localhost:8080/35/documentation/design#compaction">4.8 Log Compaction</a>
            <li><a href="http://localhost:8080/35/documentation/design#design_quotas">4.9 Quotas</a>
        </ul>
    </li>
    <li><a href="http://localhost:8080/35/documentation/implementation">5. Implementation</a>
        <ul>
            <li><a href="http://localhost:8080/35/documentation/implementation#networklayer">5.1 Network Layer</a>
            <li><a href="http://localhost:8080/35/documentation/implementation#messages">5.2 Messages</a>
            <li><a href="http://localhost:8080/35/documentation/implementation#messageformat">5.3 Message format</a>
            <li><a href="http://localhost:8080/35/documentation/implementation#log">5.4 Log</a>
            <li><a href="http://localhost:8080/35/documentation/implementation#distributionimpl">5.5 Distribution</a>
        </ul>
    </li>
    <li><a href="http://localhost:8080/35/documentation/operations">6. Operations</a>
        <ul>
            <li><a href="http://localhost:8080/35/documentation/operations#basic_ops">6.1 Basic Kafka Operations</a>
                <ul>
                    <li><a href="http://localhost:8080/35/documentation/operations#basic_ops_add_topic">Adding and removing topics</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#basic_ops_modify_topic">Modifying topics</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#basic_ops_restarting">Graceful shutdown</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#basic_ops_leader_balancing">Balancing leadership</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#basic_ops_racks">Balancing Replicas Across Racks</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#basic_ops_mirror_maker">Mirroring data between clusters</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#basic_ops_consumer_lag">Checking consumer position</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#basic_ops_consumer_group">Managing Consumer Groups</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#basic_ops_cluster_expansion">Expanding your cluster</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#basic_ops_decommissioning_brokers">Decommissioning brokers</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#basic_ops_increase_replication_factor">Increasing replication factor</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#rep-throttle">Limiting Bandwidth Usage during Data Migration</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#quotas">Setting quotas</a></li>
                </ul>
            </li>
            <li><a href="http://localhost:8080/35/documentation/operations#datacenters">6.2 Datacenters</a></li>
            <li><a href="http://localhost:8080/35/documentation/operations#georeplication">6.3 Geo-Replication (Cross-Cluster Data Mirroring)</a>
                <ul>
                    <li><a href="http://localhost:8080/35/documentation/operations#georeplication-overview">Geo-Replication Overview</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#georeplication-flows">What Are Replication Flows</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#georeplication-mirrormaker">Configuring Geo-Replication</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#georeplication-starting">Starting Geo-Replication</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#georeplication-stopping">Stopping Geo-Replication</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#georeplication-apply-config-changes">Applying Configuration Changes</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#georeplication-monitoring">Monitoring Geo-Replication</a></li>
                </ul>
            </li>
            <li><a href="http://localhost:8080/35/documentation/operations#multitenancy">6.4 Multi-Tenancy</a>
                <ul>
                    <li><a href="http://localhost:8080/35/documentation/operations#multitenancy-overview">Multi-Tenancy Overview</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#multitenancy-topic-naming">Creating User Spaces (Namespaces)</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#multitenancy-topic-configs">Configuring Topics</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#multitenancy-security">Securing Clusters and Topics</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#multitenancy-isolation">Isolating Tenants</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#multitenancy-monitoring">Monitoring and Metering</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#multitenancy-georeplication">Multi-Tenancy and Geo-Replication</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#multitenancy-more">Further considerations</a></li>
                </ul>
            </li>
            <li><a href="http://localhost:8080/35/documentation/operations#config">6.5 Important Configs</a>
                <ul>
                    <li><a href="http://localhost:8080/35/documentation/operations#clientconfig">Important Client Configs</a>
                    <li><a href="http://localhost:8080/35/documentation/operations#prodconfig">A Production Server Configs</a>
                </ul>
            </li>
            <li><a href="http://localhost:8080/35/documentation/operations#java">6.6 Java Version</a>
            <li><a href="http://localhost:8080/35/documentation/operations#hwandos">6.7 Hardware and OS</a>
                <ul>
                    <li><a href="http://localhost:8080/35/documentation/operations#os">OS</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#diskandfs">Disks and Filesystems</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#appvsosflush">Application vs OS Flush Management</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#linuxflush">Linux Flush Behavior</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#filesystems">Filesystem Selection</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#replace_disk">Replace KRaft Controller Disk</a></li>
                </ul>
            </li>
            <li><a href="http://localhost:8080/35/documentation/operations#monitoring">6.8 Monitoring</a>
                <ul>
                    <li><a href="http://localhost:8080/35/documentation/operations#remote_jmx">Security Considerations for Remote Monitoring using JMX</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#kraft_monitoring">KRaft Monitoring</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#selector_monitoring">Selector Monitoring</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#common_node_monitoring">Common Node Monitoring</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#producer_monitoring">Producer Monitoring</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#consumer_monitoring">Consumer Monitoring</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#connect_monitoring">Connect Monitoring</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#kafka_streams_monitoring">Streams Monitoring</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#others_monitoring">Others</a></li>
                </ul>
            </li>
            <li><a href="http://localhost:8080/35/documentation/operations#zk">6.9 ZooKeeper</a>
                <ul>
                    <li><a href="http://localhost:8080/35/documentation/operations#zkversion">Stable Version</a>
                    <li><a href="http://localhost:8080/35/documentation/operations#zkops">Operationalization</a>
                </ul>
            </li>
            <li><a href="http://localhost:8080/35/documentation/operations#kraft">6.10 KRaft</a>
                <ul>
                    <li><a href="http://localhost:8080/35/documentation/operations#kraft_config">Configuration</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#kraft_storage">Storage Tool</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#kraft_debug">Debugging</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#kraft_deployment">Deploying Considerations</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#kraft_missing">Missing Features</a></li>
                    <li><a href="http://localhost:8080/35/documentation/operations#kraft_zk_migration">ZooKeeper to KRaft Migration</a></li>
                </ul>
            </li>
        </ul>
    </li>
    <li><a href="http://localhost:8080/35/documentation/security">7. Security</a>
        <ul>
            <li><a href="http://localhost:8080/35/documentation/security#security_overview">7.1 Security Overview</a></li>
            <li><a href="http://localhost:8080/35/documentation/security#listener_configuration">7.2 Listener Configuration</a></li>
            <li><a href="http://localhost:8080/35/documentation/security#security_ssl">7.3 Encryption and Authentication using SSL</a></li>
            <li><a href="http://localhost:8080/35/documentation/security#security_sasl">7.4 Authentication using SASL</a></li>
            <li><a href="http://localhost:8080/35/documentation/security#security_authz">7.5 Authorization and ACLs</a></li>
            <li><a href="http://localhost:8080/35/documentation/security#security_rolling_upgrade">7.6 Incorporating Security Features in a Running Cluster</a></li>
            <li><a href="http://localhost:8080/35/documentation/security#zk_authz">7.7 ZooKeeper Authentication</a>
                <ul>
                    <li><a href="http://localhost:8080/35/documentation/security#zk_authz_new">New Clusters</a>
                        <ul>
                            <li><a href="http://localhost:8080/35/documentation/security#zk_authz_new_sasl">ZooKeeper SASL Authentication</a></li>
                            <li><a href="http://localhost:8080/35/documentation/security#zk_authz_new_mtls">ZooKeeper Mutual TLS Authentication</a></li>
                        </ul>
                    <li><a href="http://localhost:8080/35/documentation/security#zk_authz_migration">Migrating Clusters</a></li>
                    <li><a href="http://localhost:8080/35/documentation/security#zk_authz_ensemble">Migrating the ZooKeeper Ensemble</a></li>
                    <li><a href="http://localhost:8080/35/documentation/security#zk_authz_quorum">ZooKeeper Quorum Mutual TLS Authentication</a></li>
                </ul>
            <li><a href="http://localhost:8080/35/documentation/security#zk_encryption">7.8 ZooKeeper Encryption</a></li>
        </ul>
    </li>
    <li><a href="http://localhost:8080/35/documentation/connect">8. Kafka Connect</a>
        <ul>
            <li><a href="http://localhost:8080/35/documentation/connect#connect_overview">8.1 Overview</a></li>
            <li><a href="http://localhost:8080/35/documentation/connect#connect_user">8.2 User Guide</a>
                <ul>
                    <li><a href="http://localhost:8080/35/documentation/connect#connect_running">Running Kafka Connect</a></li>
                    <li><a href="http://localhost:8080/35/documentation/connect#connect_configuring">Configuring Connectors</a></li>
                    <li><a href="http://localhost:8080/35/documentation/connect#connect_transforms">Transformations</a></li>
                    <li><a href="http://localhost:8080/35/documentation/connect#connect_rest">REST API</a></li>
                    <li><a href="http://localhost:8080/35/documentation/connect#connect_errorreporting">Error Reporting in Connect</a></li>
                </ul>
            <li><a href="http://localhost:8080/35/documentation/connect#connect_development">8.3 Connector Development Guide</a></li>
        </ul>
    </li>
    <li><a href="http://localhost:8080/35/documentation/streams">9. Kafka Streams</a>
        <ul>
            <li><a href="http://localhost:8080/35/documentation/streams/quickstart">9.1 Play with a Streams Application</a></li>
            <li><a href="http://localhost:8080/35/documentation/streams/tutorial">9.2 Write your own Streams Applications</a></li>
            <li><a href="http://localhost:8080/35/documentation/streams/developer-guide">9.3 Developer Manual</a></li>
            <li><a href="http://localhost:8080/35/documentation/streams/core-concepts">9.4 Core Concepts</a></li>
            <li><a href="http://localhost:8080/35/documentation/streams/architecture">9.5 Architecture</a></li>
            <li><a href="http://localhost:8080/35/documentation/streams/upgrade-guide">9.6 Upgrade Guide</a></li>
        </ul>
    </li>
</ul>

        </div>
        <div class="right">
            <article class="markdown"><h1 id="interactive-queries">
  Interactive Queries
  <a class="anchor" href="#interactive-queries">#</a>
</h1>
<p>Interactive queries allow you to leverage the state of your application
from outside your application. The Kafka Streams enables your
applications to be queryable.</p>
<p><strong>Table of Contents</strong></p>
<ul>
<li><a href="#querying-local-state-stores-for-an-app-instance">Querying local state stores for an app instance</a>
<ul>
<li><a href="#querying-local-key-value-stores">Querying local key-value stores</a></li>
<li><a href="#querying-local-window-stores">Querying local window stores</a></li>
<li><a href="#querying-local-custom-state-stores">Querying local custom state stores</a></li>
</ul>
</li>
<li><a href="#querying-remote-state-stores-for-the-entire-app">Querying remote state stores for the entire app</a>
<ul>
<li><a href="#adding-an-rpc-layer-to-your-application">Adding an RPC layer to your application</a></li>
<li><a href="#exposing-the-rpc-endpoints-of-your-application">Exposing the RPC endpoints of your application</a></li>
<li><a href="#discovering-and-accessing-application-instances-and-their-local-state-stores">Discovering and accessing application instances and their local state stores</a></li>
</ul>
</li>
<li><a href="#demo-applications">Demo applications</a></li>
</ul>
<p>The full state of your application is typically
<a href="../architecture.html#streams_architecture_state">split across many distributed instances of your application</a>,
and across many state stores that are managed locally by these application instances.</p>
<p><img src="/images/streams-interactive-queries-03.png" alt="" />{.centered}</p>
<p>There are local and remote components to interactively querying the
state of your application.</p>
<dl>
<dt>Local state</dt>
<dd>An application instance can query the locally managed portion of the
state and directly query its own local state stores. You can use the
corresponding local data in other parts of your application code, as
long as it doesn&rsquo;t require calling the Kafka Streams API. Querying
state stores is always read-only to guarantee that the underlying
state stores will never be mutated out-of-band (e.g., you cannot add
new entries). State stores should only be mutated by the
corresponding processor topology and the input data it operates on.
For more information, see <a href="#streams-developer-guide-interactive-queries-local-stores">Querying local state stores for an app instance</a>.</dd>
<dt>Remote state</dt>
<dd>
<p>To query the full state of your application, you must connect the
various fragments of the state, including:</p>
<ul>
<li>query local state stores</li>
<li>discover all running instances of your application in the
network and their state stores</li>
<li>communicate with these instances over the network (e.g., an RPC
layer)</li>
</ul>
<p>Connecting these fragments enables communication between instances
of the same app and communication from other applications for
interactive queries. For more information, see <a href="#streams-developer-guide-interactive-queries-discovery">Querying remote
state stores for the entire app</a>.</p>
</dd>
</dl>
<p>Kafka Streams natively provides all of the required functionality for
interactively querying the state of your application, except if you want
to expose the full state of your application via interactive queries. To
allow application instances to communicate over the network, you must
add a Remote Procedure Call (RPC) layer to your application (e.g., REST
API).</p>
<p>This table shows the Kafka Streams native communication support for
various procedures.</p>
<p>//TODO fix table</p>
<hr>
<p>Procedure                     Application         Entire application
instance</p>
<hr>
<p>Query local state stores of   Supported           Supported
an app instance</p>
<p>Make an app instance          Supported           Supported
discoverable to others</p>
<p>Discover all running app      Supported           Supported
instances and their state                      <br>
stores</p>
<h2 id="rpc">
  Communicate with app          Supported           Not supported (you
instances over the network                        must configure)
(RPC)
  <a class="anchor" href="#rpc">#</a>
</h2>
<h2 id="querying-local-state-stores-for-an-app-instance">
  Querying local state stores for an app instance
  <a class="anchor" href="#querying-local-state-stores-for-an-app-instance">#</a>
</h2>
<p>A Kafka Streams application typically runs on multiple instances. The
state that is locally available on any given instance is only a subset
of the <a href="../architecture.html#streams-architecture-state">application&rsquo;s entire state</a>.
Querying the local stores on an instance will only return
data locally available on that particular instance.</p>
<p>The method <code>KafkaStreams#store(...)</code> finds
an application instance&rsquo;s local state stores by name and type.</p>
<p><img src="/images/streams-interactive-queries-api-01.png" alt="" /></p>
<p>[Every application instance can directly query any of its local state
stores.]</p>
<p>The <em>name</em> of a state store is defined when you create the store. You
can create the store explicitly by using the Processor API or implicitly
by using stateful operations in the DSL.</p>
<p>The <em>type</em> of a state store is defined by
<code>QueryableStoreType</code>. You can access the
built-in types via the class <code>QueryableStoreTypes</code>.
Kafka Streams currently has two built-in types:</p>
<ul>
<li>A key-value store <code>QueryableStoreTypes#keyValueStore()</code>, see <a href="#streams-developer-guide-interactive-queries-local-key-value-stores">Querying local key-value stores</a>.</li>
<li>A window store <code>QueryableStoreTypes#windowStore()</code>, see <a href="#streams-developer-guide-interactive-queries-local-window-stores">Querying local window stores</a>.</li>
</ul>
<p>You can also <a href="#streams-developer-guide-interactive-queries-custom-stores">implement your own QueryableStoreType</a>
as described in section <a href="#streams-developer-guide-interactive-queries-custom-stores">Querying local custom state stores</a>.</p>
<p><strong>Note</strong></p>
<p>Kafka Streams materializes one state store per stream partition. This
means your application will potentially manage many underlying state
stores. The API enables you to query all of the underlying stores
without having to know which partition the data is in.</p>
<h3 id="querying-local-key-value-stores">
  Querying local key-value stores
  <a class="anchor" href="#querying-local-key-value-stores">#</a>
</h3>
<p>To query a local key-value store, you must first create a topology with
a key-value store. This example creates a key-value store named
&ldquo;CountsKeyValueStore&rdquo;. This store will hold the latest count for any
word that is found on the topic &ldquo;word-count-input&rdquo;.</p>
<pre tabindex="0"><code class="language-line-numbers" data-lang="line-numbers">Properties  props = ...;
StreamsBuilder builder = ...;
KStream&lt;String, String&gt; textLines = ...;

// Define the processing topology (here: WordCount)
KGroupedStream&lt;String, String&gt; groupedByWord = textLines
  .flatMapValues(value -&gt; Arrays.asList(value.toLowerCase().split(&#34;\\W+&#34;)))
  .groupBy((key, word) -&gt; word, Grouped.with(stringSerde, stringSerde));

// Create a key-value store named &#34;CountsKeyValueStore&#34; for the all-time word counts
groupedByWord.count(Materialized.&lt;String, String, KeyValueStore&lt;Bytes, byte[]&gt;as(&#34;CountsKeyValueStore&#34;));

// Start an instance of the topology
KafkaStreams streams = new KafkaStreams(builder, props);
streams.start();
</code></pre><p>After the application has started, you can get access to
&ldquo;CountsKeyValueStore&rdquo; and then query it via the
<a href="https://github.com/apache/kafka/blob/%7B%7BdotVersion%7D%7D/streams/src/main/java/org/apache/kafka/streams/state/ReadOnlyKeyValueStore.java">ReadOnlyKeyValueStore</a> API:</p>
<pre tabindex="0"><code class="language-line-numbers" data-lang="line-numbers">// Get the key-value store CountsKeyValueStore
ReadOnlyKeyValueStore&lt;String, Long&gt; keyValueStore =
    streams.store(&#34;CountsKeyValueStore&#34;, QueryableStoreTypes.keyValueStore());

// Get value by key
System.out.println(&#34;count for hello:&#34; + keyValueStore.get(&#34;hello&#34;));

// Get the values for a range of keys available in this application instance
KeyValueIterator&lt;String, Long&gt; range = keyValueStore.range(&#34;all&#34;, &#34;streams&#34;);
while (range.hasNext()) {
  KeyValue&lt;String, Long&gt; next = range.next();
  System.out.println(&#34;count for &#34; + next.key + &#34;: &#34; + next.value);
}

// Get the values for all of the keys available in this application instance
KeyValueIterator&lt;String, Long&gt; range = keyValueStore.all();
while (range.hasNext()) {
  KeyValue&lt;String, Long&gt; next = range.next();
  System.out.println(&#34;count for &#34; + next.key + &#34;: &#34; + next.value);
}
</code></pre><p>You can also materialize the results of stateless operators by using the
overloaded methods that take a <code>queryableStoreName</code> as shown in the example below:</p>
<pre tabindex="0"><code class="language-line-numbers" data-lang="line-numbers">StreamsBuilder builder = ...;
KTable&lt;String, Integer&gt; regionCounts = ...;

// materialize the result of filtering corresponding to odd numbers
// the &#34;queryableStoreName&#34; can be subsequently queried.
KTable&lt;String, Integer&gt; oddCounts = numberLines.filter((region, count) -&gt; (count % 2 != 0),
  Materialized.&lt;String, Integer, KeyValueStore&lt;Bytes, byte[]&gt;as(&#34;queryableStoreName&#34;));

// do not materialize the result of filtering corresponding to even numbers
// this means that these results will not be materialized and cannot be queried.
KTable&lt;String, Integer&gt; oddCounts = numberLines.filter((region, count) -&gt; (count % 2 == 0));
</code></pre><h3 id="querying-local-window-stores">
  Querying local window stores
  <a class="anchor" href="#querying-local-window-stores">#</a>
</h3>
<p>A window store will potentially have many results for any given key
because the key can be present in multiple windows. However, there is
only one result per window for a given key.</p>
<p>To query a local window store, you must first create a topology with a
window store. This example creates a window store named
&ldquo;CountsWindowStore&rdquo; that contains the counts for words in 1-minute
windows.</p>
<pre tabindex="0"><code class="language-line-numbers" data-lang="line-numbers">StreamsBuilder builder = ...;
KStream&lt;String, String&gt; textLines = ...;

// Define the processing topology (here: WordCount)
KGroupedStream&lt;String, String&gt; groupedByWord = textLines
  .flatMapValues(value -&gt; Arrays.asList(value.toLowerCase().split(&#34;\\W+&#34;)))
  .groupBy((key, word) -&gt; word, Grouped.with(stringSerde, stringSerde));

// Create a window state store named &#34;CountsWindowStore&#34; that contains the word counts for every minute
groupedByWord.windowedBy(TimeWindows.ofSizeWithNoGrace(Duration.ofSeconds(60)))
  .count(Materialized.&lt;String, Long, WindowStore&lt;Bytes, byte[]&gt;as(&#34;CountsWindowStore&#34;));
</code></pre><p>After the application has started, you can get access to
&ldquo;CountsWindowStore&rdquo; and then query it via the
<a href="https://github.com/apache/kafka/blob/%7B%7BdotVersion%7D%7D/streams/src/main/java/org/apache/kafka/streams/state/ReadOnlyWindowStore.java">ReadOnlyWindowStore</a> API:</p>
<pre tabindex="0"><code class="language-line-numbers" data-lang="line-numbers">// Get the window store named &#34;CountsWindowStore&#34;
ReadOnlyWindowStore&lt;String, Long&gt; windowStore =
    streams.store(&#34;CountsWindowStore&#34;, QueryableStoreTypes.windowStore());

// Fetch values for the key &#34;world&#34; for all of the windows available in this application instance.
// To get *all* available windows we fetch windows from the beginning of time until now.
Instant timeFrom = Instant.ofEpochMilli(0); // beginning of time = oldest available
Instant timeTo = Instant.now(); // now (in processing-time)
WindowStoreIterator&lt;Long&gt; iterator = windowStore.fetch(&#34;world&#34;, timeFrom, timeTo);
while (iterator.hasNext()) {
  KeyValue&lt;Long, Long&gt; next = iterator.next();
  long windowTimestamp = next.key;
  System.out.println(&#34;Count of &#39;world&#39; @ time &#34; + windowTimestamp + &#34; is &#34; + next.value);
}
</code></pre><h3 id="querying-local-custom-state-stores">
  Querying local custom state stores
  <a class="anchor" href="#querying-local-custom-state-stores">#</a>
</h3>
<p><strong>Note</strong></p>
<p>Only the <a href="processor-api.html#streams-developer-guide-processor-api">Processor API</a> supports custom state stores.</p>
<p>Before querying the custom state stores you must implement these interfaces:</p>
<ul>
<li>Your custom state store must implement <code>StateStore</code>.</li>
<li>You must have an interface to represent the operations available on
the store.</li>
<li>You must provide an implementation of <code>StoreBuilder</code> for creating instances of your store.</li>
<li>It is recommended that you provide an interface that restricts
access to read-only operations. This prevents users of this API from
mutating the state of your running Kafka Streams application
out-of-band.</li>
</ul>
<p>The class/interface hierarchy for your custom store might look something like:</p>
<pre tabindex="0"><code class="language-line-numbers" data-lang="line-numbers">public class MyCustomStore&lt;K,V&gt; implements StateStore, MyWriteableCustomStore&lt;K,V&gt; {
  // implementation of the actual store
}

// Read-write interface for MyCustomStore
public interface MyWriteableCustomStore&lt;K,V&gt; extends MyReadableCustomStore&lt;K,V&gt; {
  void write(K Key, V value);
}

// Read-only interface for MyCustomStore
public interface MyReadableCustomStore&lt;K,V&gt; {
  V read(K key);
}

public class MyCustomStoreBuilder implements StoreBuilder {
  // implementation of the supplier for MyCustomStore
}
</code></pre><p>To make this store queryable you must:</p>
<ul>
<li>Provide an implementation of
<a href="https://github.com/apache/kafka/blob/%7B%7BdotVersion%7D%7D/streams/src/main/java/org/apache/kafka/streams/state/QueryableStoreType.java">QueryableStoreType</a>.</li>
<li>Provide a wrapper class that has access to all of the underlying
instances of the store and is used for querying.</li>
</ul>
<p>Here is how to implement <code>QueryableStoreType</code>:</p>
<pre tabindex="0"><code class="language-line-numbers" data-lang="line-numbers">public class MyCustomStoreType&lt;K,V&gt; implements QueryableStoreType&lt;MyReadableCustomStore&lt;K,V&gt;&gt; {

  // Only accept StateStores that are of type MyCustomStore
  public boolean accepts(final StateStore stateStore) {
    return stateStore instanceOf MyCustomStore;
  }

  public MyReadableCustomStore&lt;K,V&gt; create(final StateStoreProvider storeProvider, final String storeName) {
      return new MyCustomStoreTypeWrapper(storeProvider, storeName, this);
  }

}
</code></pre><p>A wrapper class is required because each instance of a Kafka Streams
application may run multiple stream tasks and manage multiple local
instances of a particular state store. The wrapper class hides this
complexity and lets you query a &ldquo;logical&rdquo; state store by name without
having to know about all of the underlying local instances of that state
store.</p>
<p>When implementing your wrapper class you must use the
<a href="https://github.com/apache/kafka/blob/%7B%7BdotVersion%7D%7D/streams/src/main/java/org/apache/kafka/streams/state/internals/StateStoreProvider.java">StateStoreProvider</a> interface to get access to the underlying instances of your
store. <code>StateStoreProvider#stores(String storeName, QueryableStoreType&lt;T&gt; queryableStoreType)</code> returns a <code>List</code> of state
stores with the given storeName and of the type as defined by
<code>queryableStoreType</code>.</p>
<p>Here is an example implementation of the wrapper follows (Java 8+):</p>
<pre tabindex="0"><code class="language-line-numbers" data-lang="line-numbers">// We strongly recommended implementing a read-only interface
// to restrict usage of the store to safe read operations!
public class MyCustomStoreTypeWrapper&lt;K,V&gt; implements MyReadableCustomStore&lt;K,V&gt; {

  private final QueryableStoreType&lt;MyReadableCustomStore&lt;K, V&gt;&gt; customStoreType;
  private final String storeName;
  private final StateStoreProvider provider;

  public CustomStoreTypeWrapper(final StateStoreProvider provider,
                              final String storeName,
                              final QueryableStoreType&lt;MyReadableCustomStore&lt;K, V&gt;&gt; customStoreType) {

    // ... assign fields ...
  }

  // Implement a safe read method
  @Override
  public V read(final K key) {
    // Get all the stores with storeName and of customStoreType
    final List&lt;MyReadableCustomStore&lt;K, V&gt;&gt; stores = provider.getStores(storeName, customStoreType);
    // Try and find the value for the given key
    final Optional&lt;V&gt; value = stores.stream().filter(store -&gt; store.read(key) != null).findFirst();
    // Return the value if it exists
    return value.orElse(null);
  }

}
</code></pre><p>You can now find and query your custom store:</p>
<pre tabindex="0"><code class="language-line-numbers" data-lang="line-numbers">Topology topology = ...;
ProcessorSupplier processorSuppler = ...;

// Create CustomStoreSupplier for store name the-custom-store
MyCustomStoreBuilder customStoreBuilder = new MyCustomStoreBuilder(&#34;the-custom-store&#34;) //...;
// Add the source topic
topology.addSource(&#34;input&#34;, &#34;inputTopic&#34;);
// Add a custom processor that reads from the source topic
topology.addProcessor(&#34;the-processor&#34;, processorSupplier, &#34;input&#34;);
// Connect your custom state store to the custom processor above
topology.addStateStore(customStoreBuilder, &#34;the-processor&#34;);

KafkaStreams streams = new KafkaStreams(topology, config);
streams.start();

// Get access to the custom store
MyReadableCustomStore&lt;String,String&gt; store = streams.store(&#34;the-custom-store&#34;, new MyCustomStoreType&lt;String,String&gt;());
// Query the store
String value = store.read(&#34;key&#34;);
</code></pre><h2 id="querying-remote-state-stores-for-the-entire-app">
  Querying remote state stores for the entire app
  <a class="anchor" href="#querying-remote-state-stores-for-the-entire-app">#</a>
</h2>
<p>To query remote states for the entire app, you must expose the
application&rsquo;s full state to other applications, including applications
that are running on different machines.</p>
<p>For example, you have a Kafka Streams application that processes user
events in a multi-player video game, and you want to retrieve the latest
status of each user directly and display it in a mobile app. Here are
the required steps to make the full state of your application queryable:</p>
<ol>
<li><a href="#streams-developer-guide-interactive-queries-rpc-layer">Add an RPC layer to your application</a> so that the instances of your application can be
interacted with via the network (e.g., a REST API, Thrift, a custom
protocol, and so on). The instances must respond to interactive
queries. You can follow the reference examples provided to get
started.</li>
<li><a href="#streams-developer-guide-interactive-queries-expose-rpc">Expose the RPC endpoints</a> of your application&rsquo;s instances via the
<code>application.server</code> configuration
setting of Kafka Streams. Because RPC endpoints must be unique
within a network, each instance has its own value for this
configuration setting. This makes an application instance
discoverable by other instances.</li>
<li>In the RPC layer, <a href="#streams-developer-guide-interactive-queries-discover-app-instances-and-stores">discover remote application instances</a>
and their state stores and <a href="#streams-developer-guide-interactive-queries-local-stores">query locally available state stores</a>
to make the full state of your application queryable. The
remote application instances can forward queries to other app
instances if a particular instance lacks the local data to respond
to a query. The locally available state stores can directly respond
to queries.</li>
</ol>
<p><img src="/%7B%7Bversion%7D%7D/images/streams-interactive-queries-api-02.png" alt="" /></p>
<p>[Discover any running instances of the same application as well as the
respective RPC endpoints they expose for interactive
queries]</p>
<h3 id="adding-an-rpc-layer-to-your-application">
  Adding an RPC layer to your application
  <a class="anchor" href="#adding-an-rpc-layer-to-your-application">#</a>
</h3>
<p>There are many ways to add an RPC layer. The only requirements are that
the RPC layer is embedded within the Kafka Streams application and that
it exposes an endpoint that other application instances and applications
can connect to.</p>
<h3 id="exposing-the-rpc-endpoints-of-your-application">
  Exposing the RPC endpoints of your application
  <a class="anchor" href="#exposing-the-rpc-endpoints-of-your-application">#</a>
</h3>
<p>To enable remote state store discovery in a distributed Kafka Streams
application, you must set the <a href="config-streams.html#streams-developer-guide-required-configs">configuration property</a>
in the config properties. The <code>application.server</code> property defines a unique <code>host:port</code> pair that points to the RPC endpoint of the respective
instance of a Kafka Streams application. The value of this configuration
property will vary across the instances of your application. When this
property is set, Kafka Streams will keep track of the RPC endpoint
information for every instance of an application, its state stores, and
assigned stream partitions through instances of
<a href="/%7B%7Bversion%7D%7D/javadoc/org/apache/kafka/streams/state/StreamsMetadata.html">StreamsMetadata</a>.</p>
<p><strong>Tip</strong></p>
<p>Consider leveraging the exposed RPC endpoints of your application for
further functionality, such as piggybacking additional inter-application
communication that goes beyond interactive queries.</p>
<p>This example shows how to configure and run a Kafka Streams application
that supports the discovery of its state stores.</p>
<pre tabindex="0"><code class="language-line-numbers" data-lang="line-numbers">Properties props = new Properties();
// Set the unique RPC endpoint of this application instance through which it
// can be interactively queried.  In a real application, the value would most
// probably not be hardcoded but derived dynamically.
String rpcEndpoint = &#34;host1:4460&#34;;
props.put(StreamsConfig.APPLICATION_SERVER_CONFIG, rpcEndpoint);
// ... further settings may follow here ...

StreamsBuilder builder = new StreamsBuilder();

KStream&lt;String, String&gt; textLines = builder.stream(stringSerde, stringSerde, &#34;word-count-input&#34;);

final KGroupedStream&lt;String, String&gt; groupedByWord = textLines
    .flatMapValues(value -&gt; Arrays.asList(value.toLowerCase().split(&#34;\\W+&#34;)))
    .groupBy((key, word) -&gt; word, Grouped.with(stringSerde, stringSerde));

// This call to `count()` creates a state store named &#34;word-count&#34;.
// The state store is discoverable and can be queried interactively.
groupedByWord.count(Materialized.&lt;String, Long, KeyValueStore&lt;Bytes, byte[]&gt;as(&#34;word-count&#34;));

// Start an instance of the topology
KafkaStreams streams = new KafkaStreams(builder, props);
streams.start();

// Then, create and start the actual RPC service for remote access to this
// application instance&#39;s local state stores.
//
// This service should be started on the same host and port as defined above by
// the property `StreamsConfig.APPLICATION_SERVER_CONFIG`.  The example below is
// fictitious, but we provide end-to-end demo applications (such as KafkaMusicExample)
// that showcase how to implement such a service to get you started.
MyRPCService rpcService = ...;
rpcService.listenAt(rpcEndpoint);
</code></pre><h3 id="discovering-and-accessing-application-instances-and-their-local-state-stores">
  Discovering and accessing application instances and their local state stores
  <a class="anchor" href="#discovering-and-accessing-application-instances-and-their-local-state-stores">#</a>
</h3>
<p>The following methods return
<a href="/%7B%7Bversion%7D%7D/javadoc/org/apache/kafka/streams/state/StreamsMetadata.html">StreamsMetadata</a> objects,
which provide meta-information about application
instances such as their RPC endpoint and locally available state stores.</p>
<ul>
<li><code>KafkaStreams#allMetadata()</code>: find all
instances of this application</li>
<li><code>KafkaStreams#allMetadataForStore(String storeName)</code>: find those applications instances that manage
local instances of the state store &ldquo;storeName&rdquo;</li>
<li><code>KafkaStreams#metadataForKey(String storeName, K key, Serializer&lt;K&gt; keySerializer)</code>: using the default stream partitioning strategy,
find the one application instance that holds the data for the given
key in the given state store</li>
<li><code>KafkaStreams#metadataForKey(String storeName, K key,`` </code>{.docutils
.literal}<code>StreamPartitioner&lt;K, ?&gt; partitioner)</code>: using <code>partitioner</code>,
find the one application instance that holds the data for the given
key in the given state store</li>
</ul>
<p>Attention</p>
<p>If <code>application.server</code> is not configured
for an application instance, then the above methods will not find any
<a href="/%7B%7Bversion%7D%7D/javadoc/org/apache/kafka/streams/state/StreamsMetadata.html">StreamsMetadata</a> for it.</p>
<p>For example, we can now find the <code>StreamsMetadata</code> for the state store named &ldquo;word-count&rdquo; that we defined
in the code example shown in the previous section:</p>
<pre tabindex="0"><code class="language-line-numbers" data-lang="line-numbers">KafkaStreams streams = ...;
// Find all the locations of local instances of the state store named &#34;word-count&#34;
Collection&lt;StreamsMetadata&gt; wordCountHosts = streams.allMetadataForStore(&#34;word-count&#34;);

// For illustrative purposes, we assume using an HTTP client to talk to remote app instances.
HttpClient http = ...;

// Get the word count for word (aka key) &#39;alice&#39;: Approach 1
//
// We first find the one app instance that manages the count for &#39;alice&#39; in its local state stores.
StreamsMetadata metadata = streams.metadataForKey(&#34;word-count&#34;, &#34;alice&#34;, Serdes.String().serializer());
// Then, we query only that single app instance for the latest count of &#39;alice&#39;.
// Note: The RPC URL shown below is fictitious and only serves to illustrate the idea.  Ultimately,
// the URL (or, in general, the method of communication) will depend on the RPC layer you opted to
// implement.  Again, we provide end-to-end demo applications (such as KafkaMusicExample) that showcase
// how to implement such an RPC layer.
Long result = http.getLong(&#34;http://&#34; + metadata.host() + &#34;:&#34; + metadata.port() + &#34;/word-count/alice&#34;);

// Get the word count for word (aka key) &#39;alice&#39;: Approach 2
//
// Alternatively, we could also choose (say) a brute-force approach where we query every app instance
// until we find the one that happens to know about &#39;alice&#39;.
Optional&lt;Long&gt; result = streams.allMetadataForStore(&#34;word-count&#34;)
    .stream()
    .map(streamsMetadata -&gt; {
        // Construct the (fictituous) full endpoint URL to query the current remote application instance
        String url = &#34;http://&#34; + streamsMetadata.host() + &#34;:&#34; + streamsMetadata.port() + &#34;/word-count/alice&#34;;
        // Read and return the count for &#39;alice&#39;, if any.
        return http.getLong(url);
    })
    .filter(s -&gt; s != null)
    .findFirst();
</code></pre><p>At this point the full state of the application is interactively
queryable:</p>
<ul>
<li>You can discover the running instances of the application and the
state stores they manage locally.</li>
<li>Through the RPC layer that was added to the application, you can
communicate with these application instances over the network and
query them for locally available state.</li>
<li>The application instances are able to serve such queries because
they can directly query their own local state stores and respond via
the RPC layer.</li>
<li>Collectively, this allows us to query the full state of the entire
application.</li>
</ul>
<p>To see an end-to-end application with interactive queries, review the
<a href="#streams-developer-guide-interactive-queries-demos">demo applications</a>.</p>
</article>
        </div>
    </div>
</div>
<div class="footer">
    <div class="footer__inner">
        <div class="footer__legal">
            <span class="footer__legal__one">The contents of this website are &copy; 2023 <a
                    href="https://www.apache.org/" target="_blank">Apache Software Foundation</a> under the terms of the <a
                    href="https://www.apache.org/licenses/LICENSE-2.0.html"
                    target="_blank">Apache License v2</a>.</span>
            <span class="footer__legal__two">Apache Kafka, Kafka, and the Kafka logo are either registered trademarks or trademarks of The Apache Software Foundation</span>
            <span class="footer__legal__three">in the United States and other countries.</span>
            <div>
                <a href="https://kafka.apache.org/project-security" target="_blank" rel="noreferrer">Security</a>&nbsp;|&nbsp;
                <a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noreferrer">Donate</a>&nbsp;|&nbsp;
                <a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noreferrer">Thanks</a>&nbsp;|&nbsp;
                <a href="https://apache.org/events/current-event" target="_blank" rel="noreferrer">Events</a>&nbsp;|&nbsp;
                <a href="https://apache.org/licenses/" target="_blank" rel="noreferrer">License</a>&nbsp;|&nbsp;
                <a href="https://privacy.apache.org/policies/privacy-policy-public.html" target="_blank"
                   rel="noreferrer">Privacy</a>
            </div>
        </div>
        <a class="apache-feather" target="_blank" href="http://www.apache.org">
            <img width="40" src="http://localhost:8080/35/documentation/images/feather-small.png" alt="Apache Feather">
        </a>
    </div>
</div>


<script src="http://localhost:8080/35/documentation/js/handlebars.js"></script>
<script>
			$(function () {
				
				var templates = [
					'introduction',
					'implementation',
					'design',
					'api',
					'configuration',
					'ops',
					'security',
					'connect',
					'streams',
					'quickstart',
					'quickstart-docker',
					'toc',
					'upgrade',
					'content'
				];

				
				for(var i = 0; i < templates.length; i++) {
					var templateScript = $("#" + templates[i] + "-template").html();
					if(templateScript) {
						var template = Handlebars.compile(templateScript);
						var html = template(context);
						$(".p-" + templates[i]).html(html);
					}
				}
			});






</script>

<script src="http://localhost:8080/35/documentation/js/jquery.sticky-kit.min.js"></script>
<script>

			let mobileScrolling = false;
			let mobileTimeout;

			
			function checkPageScroll() {
				if (window.scrollY >= 80 || document.body.scrollTop >= 100) {
					document.getElementById('header').classList.add('scrolled');
				} else {
					document.getElementById('header').classList.remove('scrolled');
				}
			}

			function mobilePageScroll() {
				mobileScrolling = true;
				mobileTimeout = null;
				mobileTimeout = setTimeout(checkPageScroll, 200);
			}

			function pageScroll(e) {
				requestAnimationFrame(checkPageScroll);
			};

			function setUpA11yMenus(nav) {
				const itemsWithMenu = nav.querySelectorAll('[aria-haspopup="true"]');
				const topLevelItems = nav.querySelectorAll('.top-nav-item-anchor');
				const navAnchors = nav.querySelectorAll('a');
				const menus = nav.querySelectorAll('[role="menu"]');
				const keyMap = {
					
					'left': 37, 'up': 38, 'right': 39, 'down': 40,
					
					'tab': 9, 'enter': 13, 'esc': 27, 'space': 32,
				}
				
				const keyCodes = [37, 38, 39, 40, 9, 13, 27, 32];

				
				nav.addEventListener('click', (e) => {
					if (e.target.hasAttribute('href') && e.target.getAttribute('href') === '#') {
						e.preventDefault();
						e.stopPropagation();
					}
				});

				for (let i = 0; i < topLevelItems.length; i++) {
					const item = topLevelItems[i];
					const attrNames = {
						currentFocus: 'data-current-focus',
						hidden: 'aria-hidden',
						expanded: 'aria-expanded',
					};
					
					
					const itemMenu = item.parentNode.querySelector('[role="menu"]');

					function selectPreviousMenuItem(e, keyPressed) {
						let selectedIndex = -1;

						if (!itemMenu) {
							selectPreviousTopLevelItem(e);
						}

						if (itemMenu && itemMenu.hasAttribute(attrNames.currentFocus)) {
							selectedIndex = parseInt(itemMenu.getAttribute(attrNames.currentFocus), 10);
						}
						let nextIndex = selectedIndex - 1;
						const menuItems = itemMenu.getElementsByTagName('a');

						if (nextIndex >= 0) {
						
							menuItems[nextIndex].focus();
							itemMenu.setAttribute(attrNames.currentFocus, nextIndex);
						} else if (nextIndex === -1) {
						
							item.focus();
							itemMenu.setAttribute(attrNames.currentFocus, -1);
						} else if (nextIndex === -2) {
							if (keyPressed === 'tab') {
								
								selectPreviousTopLevelItem(e);
							} else {
								
								menuItems[menuItems.length - 1].focus()
								itemMenu.setAttribute(attrNames.currentFocus, menuItems.length - 1);
							}
						}
					}

					function selectNextMenuItem(keyPressed) {
						let selectedIndex = -1;
						let nextIndex;
						let menuItems;

						if (!itemMenu) {
							selectNextTopLevelItem();
						}

						menuItems = itemMenu.getElementsByTagName('a');

						for (let j = 0; j < menuItems.length; j++) {
							if (menuItems[j] === document.activeElement) {
								selectedIndex = j;
								break;
							}
						}

						nextIndex = selectedIndex + 1;

						

						if (keyPressed === 'tab') {
							if (nextIndex >= menuItems.length) {
								selectNextTopLevelItem()
							} else {
								menuItems[nextIndex].focus();
							}
						} else {
							if (nextIndex < menuItems.length) {
								menuItems[nextIndex].focus();
							} else {
								item.focus();
							}
						}
					}

					function selectPreviousTopLevelItem() {
						let newIndex;

						for (let j = 0; j < topLevelItems.length; j++) {
							if (topLevelItems[j] === item) {
								newIndex = j - 1;
								break;
							}
						}

						if (itemMenu) {
							hideMenu();
						}

						if (newIndex < 0) {
							document.querySelector('.logo-link').focus();
						} else {
							topLevelItems[newIndex].focus();
						}
					}

					function selectNextTopLevelItem() {
						let newIndex;

						for (let j = 0; j < topLevelItems.length; j++) {
							if (topLevelItems[j] === item) {
								newIndex = j + 1;
								break;
							}
						}

						if (itemMenu) {
							hideMenu();
						}

						if (newIndex > topLevelItems.length - 1) {
							document.getElementById('top-nav-download').focus();
						} else {
							topLevelItems[newIndex].focus();
						}
					}

					function isMenuOpen() {
						return itemMenu && itemMenu.getAttribute(attrNames.hidden) === 'false';
					}

					function showMenu() {
						item.setAttribute(attrNames.expanded, 'true');
						if (itemMenu) {
							itemMenu.setAttribute(attrNames.hidden, 'false');
						}
					}

					function hideMenu() {
						item.setAttribute(attrNames.expanded, 'false');
						if (itemMenu) {
							itemMenu.setAttribute(attrNames.hidden, 'true');
							delete itemMenu.dataset.currentFocus;
						}
					}

					item.parentNode.addEventListener('mouseover', showMenu);
					item.parentNode.addEventListener('mouseout', hideMenu);
					item.parentNode.addEventListener('blur', hideMenu);
					item.addEventListener('focus', showMenu);

					
					item.parentNode.addEventListener('keydown', (e) => {
						
						if (keyCodes.indexOf(e.keyCode) > -1) {
							e.preventDefault();
							e.stopPropagation();

							switch(e.keyCode) {
								case keyMap.left:
									if (itemMenu) {
										if (!isMenuOpen()) {
											selectPreviousTopLevelItem();
										} else {
											hideMenu();
											item.focus();
										}
									} else {
										selectPreviousTopLevelItem();
									}
								break;
								case keyMap.up:
									if (itemMenu) {
										if (isMenuOpen()) {
											selectPreviousMenuItem(e, 'up');
										}
									}
								break;
								case keyMap.right:
									if (!isMenuOpen() || document.activeElement === item) {
										selectNextTopLevelItem('right');
									}
								break;
								case keyMap.down:
									if (itemMenu) {
										if (isMenuOpen()) {
											selectNextMenuItem('down');
										} else {
											showMenu();
										}
									}
								break;
								case keyMap.tab:
									const isShiftActive = e.getModifierState('Shift');
									if (itemMenu) {
										if (isShiftActive) {
											selectPreviousTopLevelItem();
										} else {
											if (isMenuOpen()) {
												selectNextMenuItem('tab');
											} else {
												showMenu();
											}
										}
									} else {
										if (isShiftActive) {
											selectPreviousTopLevelItem();
										} else {
											selectNextTopLevelItem('tab');
										}
									}
								break;
								case keyMap.esc:
									if (itemMenu && isMenuOpen()) {
										hideMenu();
									}
								break;
								default:
									
								break;
							}
						}
					});
				};
			}

			function is_touch_enabled() {
				return ( 'ontouchstart' in window ) ||
							( navigator.maxTouchPoints > 0 ) ||
							( navigator.msMaxTouchPoints > 0 );
			}

			function setupDocsNav() {
				var docsContainer = document.querySelector('.documentation--current');
				var docsHandle = document.querySelector('.toc-handle');

				function toggleDocsWidth() {
					let isExpanded = docsContainer.classList.toggle('expanded');
					
					if (isExpanded) {
						docsHandle.textContent = ">";
					} else {
						docsHandle.textContent = "<";
					}
				}

				docsHandle.addEventListener('click', toggleDocsWidth);
			}

			
			(function() {
				var navToggle = document.getElementById('top-nav-toggle');
				var nav = document.getElementById('top-nav-container');
				var docsNav = document.querySelector('.docs-nav');

				navToggle.addEventListener('click', () => {
					navToggle.classList.toggle('active');
				});

				
				if (is_touch_enabled()) {
					nav.querySelectorAll('a').forEach(anchor => anchor.removeAttribute('tabindex'));
					window.addEventListener('touchmove', mobilePageScroll, false);
				} else {
					setUpA11yMenus(nav);
					window.addEventListener('scroll', pageScroll, false);
				}

				
				document.addEventListener("DOMContentLoaded", function() {
					
					pageScroll();

					if (docsNav) {
						setupDocsNav();
					}

					
					
					
				});
			}());






</script>
</body>
</html>